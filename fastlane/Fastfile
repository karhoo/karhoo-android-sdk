FASTLANE_HIDE_CHANGELOG = true
FASTLANE_SKIP_UPDATE_CHECK = true
fastlane_version "2.62.1"

default_platform :android

platform :android do
  before_all do
    ENV["SLACK_URL"] = ""
  end

  desc "Runs all the tests"
  lane :test do
    gradle(task: "test")
    gradle(task: "testDebugUnitTestCoverage")
    gradle(task: "connectedAndroidTest")
    slack(message: "*Karhoo Android NSDK* Passed unit and integrations tests for SDK")
  end

  desc "New Build"
  lane :beta do
    gradle(task: "assemble")
    gradle(task: "install")
  end


  after_all do |lane|
    slack(
      message: "*Karhoo NSDK* has passed unit and integration tests"
    )
  end

  error do |lane, exception|
    slack(
      message: exception.message,
      success: false
    )
  end
end

